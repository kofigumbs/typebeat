<!DOCTYPE html>
<meta charset="utf-8">

<script>
  window.Module = {
    locateFile: () => '../target/wasm32-unknown-emscripten/debug/typebeat_web.wasm',
    noExitRuntime: true,
  };
  window.typebeat = async (context, { method, data }) => {
    const controller = await window.typebeat.ready;
    switch (context) {
      case 'get': return Module.ccall('get', 'number', ['number', 'string'], [controller, method]);
      case 'set': return Module.ccall('set', 'number', ['number', 'string', 'number'], [controller, method, data]);
    }
  };
  window.typebeat.ready = new Promise(resolve => {
    Module.onRuntimeInitialized = () => {
      document.querySelector('.start').addEventListener('click', () => {
        document.querySelector('.mount').classList.add('ready');
        resolve(Module.ccall('start', 'number', [], []));
      }, { once: true });
    };
  });
</script>
<script defer src="../target/wasm32-unknown-emscripten/debug/typebeat-web.js"></script>

<style>
.mount:not(.ready) {
  display: none;
}
</style>

<link rel="stylesheet" href="../static/ui/FiraCode/distr/fira_code.css">
<link rel="stylesheet" href="../static/ui/index.css">
<script defer src="../static/ui/Themes/scripts/lib/theme.js"></script>
<script defer src="../static/ui/tare/dist/tare.min.js"></script>
<script defer src="../static/ui/typed-label.js"></script>
<script defer src="../static/ui/state.js"></script>
<script defer src="../static/ui/bindings.js"></script>
<script defer src="../static/ui/index.js"></script>

<button class='start'>Start</button>
<div class="mount"></div>
